@model IEnumerable<SPMyRatingsViewModel>
@{
	ViewBag.PageTitle = "My Ratings";
	Layout = "_ServiceProviderLayout";
	string[] RatingsStrings = { "Very Bad", "Bad", "Good", "Very Good", "Excellent" };
}
@section CustomCss
{
<link rel="stylesheet" type="text/css"
	href="https://cdn.datatables.net/v/dt/dt-1.11.3/r-2.2.9/rg-1.1.4/datatables.min.css" />
<link rel="stylesheet" href="~/css/customerServiceHistory.css" asp-append-version="true">
}
<div class="serviceHistoryTableContainer">
	<h2 class="tableHeader w-100 d-flex align-items-center justify-content-between">
		My Ratings
		<div>Sorting
			<img src="~/images/filter.png" class="sortingButton ms-2" type="button" tabindex="0"
				data-bs-toggle="popover" data-bs-offset="0,15" data-bs-placement="bottom" data-bs-trigger="focus"
				data-bs-custom-class="sortingPopover myRatingSortingPopover" data-bs-html="true" data-bs-content="
						<label class='sortingRadioLabel form-check-label' for='dateDesc'>
							<input class='form-check-input box-shadow-none' checked type='radio' data-st-col='1' data-st-type='desc' name='sortingRadio' id='dateDesc' />
							Service Date: Latest
						</label>
						<label class='sortingRadioLabel form-check-label' for='dateAsc'>
							<input class='form-check-input box-shadow-none' type='radio' data-st-col='1' data-st-type='asc' name='sortingRadio' id='dateAsc' />
							Service Date: Oldest
						</label>
						<label class='sortingRadioLabel form-check-label' for='serviceIdAsc'>
							<input class='form-check-input box-shadow-none' type='radio' data-st-col='0' data-st-type='asc' name='sortingRadio' id='serviceIdAsc' />
							Service Id: Ascending
						</label>
						<label class='sortingRadioLabel form-check-label' for='serviceIdDesc'>
							<input class='form-check-input box-shadow-none' type='radio' data-st-col='0' data-st-type='desc' name='sortingRadio' id='serviceIdDesc' />
							Service Id: Decending
						</label>
						" />
		</div>
	</h2>
	<table id="myRatingsTable">
		<thead class="d-none">
			<tr>
				<th class="text-nowrap"><span class="d-inline-block">Service Details</span><span></span></th>
				<th class="text-nowrap"><span class="d-inline-block">Service Date</span><span></span></th>
				<th class="text-nowrap"><span class="d-inline-block">Ratings</span><span></span></th>
				<th class="text-nowrap"><span class="d-inline-block">Customer Comments</span><span></span></th>
			</tr>
		</thead>
		<tbody>
			@if (Model != null && Model.Any())
			{
				@foreach (var service in Model)
				{
					<tr class="row g-0 mb-3 p-2">
						<td class="serviceId col-12 col-md-3" data-us-title="Service ID :">
							<div>@service.ServiceId</div>
							<div class="fw-bold">@service.CustomerName</div>
						</td>
						<td class="col-12 col-md-6" data-us-title="Service Date :">
							<div class="tdHead d-flex align-items-center justify-content-start">
								<img src="~/images/calender.png">
								<h5>@service.ServiceDate.ToString("dd/MM/yyyy").Replace("-","/")</h5>
							</div>
							@{
								var st = service.ServiceDate.ToString("HH:mm");
								var et = service.ServiceDate.AddHours(service.ServiceHours).ToString("HH:mm");
							}
							<div class="timing d-flex align-items-center justify-content-start">
								<img src="~/images/clock.png">
								<div class="time text-nowrap">@st - @et</div>
							</div>
						</td>
						<td class="col-12 col-md-3" data-us-title="Customer Details :">
							<div>Ratings: @Math.Round(service.Ratings,2)</div>
							<div class="feedback d-flex align-items-center justify-content-start">
								<div class="stars position-relative d-flex align-items-center justify-content-center">
									@for (int i = 1; i <= 5; i++)
									{
										<svg xmlns="http://www.w3.org/2000/svg" width="17" height="16">
											<path fill-rule="evenodd" fill="#ECB91C" d="m8.176 12.865 5.045 3.735-1.334-5.78 4.453-3.84-5.871-1.402L8.176.6 5.882
										5.578.11 6.98l4.355 3.84L3.13 16.6l5.046-3.735z" />
										</svg>
									}
									<div class="cover position-absolute top-0 end-0 h-100"
								style="width: @(100-service.Ratings*20)%;"></div>
								</div>
								<span class="lh-sm ms-1">@RatingsStrings[(int)Math.Round(service.Ratings-1,0)]</span>
							</div>
						</td>
						<td class="col-12 border-top mt-0 mt-md-2 pt-1" data-us-title="Feedback :">
							<div class="fw-bold">Customer Comments</div>
							<div>@(service.Comments!=null?service.Comments:"No Comments")</div>
						</td>
					</tr>
				}
			}
		</tbody>
	</table>
</div>
@section CustomScripts{
<script type="text/javascript"
	src="https://cdn.datatables.net/v/dt/dt-1.11.3/r-2.2.9/rg-1.1.4/datatables.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.1.0/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.1.0/js/buttons.html5.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script src="~/js/spMyRatings.js" asp-append-version="true"></script>
}